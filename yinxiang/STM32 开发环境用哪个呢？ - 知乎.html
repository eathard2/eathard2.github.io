<html>
<head>
  <title>STM32 开发环境用哪个呢？ - 知乎</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/304720 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="564"/>
<h1>STM32 开发环境用哪个呢？ - 知乎</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2017/4/10 10:18</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="https://www.zhihu.com/question/21416946"><i>https://www.zhihu.com/question/21416946</i></a></td></tr>
</table>
</div>
<br/>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div><div style="font-family:&quot;Helvetica Neue&quot;, Helvetica, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, Arial, sans-serif;font-size:15px;color:rgb(38, 38, 38);background:rgb(247, 248, 250);-webkit-tap-highlight-color:rgba(0, 0, 0, 0);"><div><div><span><div><div style="-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:start;align-items:flex-start;"><div><div><div style="background:rgb(255, 255, 255);border-radius:2px;box-shadow:rgba(0, 37, 55, 0.0470588) 0px 1px 3px;box-sizing:border-box;"><div><div><div style="font-size:14px;"><div><div style="font-size:15px;line-height:25px;"><div style="overflow:hidden;"><span style="word-break:break-word;white-space:pre-wrap;">eclipse + arm-none-eabi-gcc自己搭建<br/>搭建完你会更了解他<br/>---------------------分割线-------------------------<br/>最近私信如何搭建的比较多，放出几年前总结的笔记，考虑到年代已久，建议更新相关软件/插件到最新。<br/><br/>作者：shoko camel<br/>链接：<a href="https://zhuanlan.zhihu.com/p/25199304" style="color:inherit;text-decoration:none;cursor:pointer;border-bottom:1px solid rgba(64, 64, 64, 0.721569);">知乎专栏</a><br/>来源：知乎<br/>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。<br/><br/>缘起，某年周末无聊，尝试搭建环境的一篇笔记，看了笔记的时间是2013年11月份。<p style="margin:0px;margin-bottom:0.72em;">考虑时不时收到询问Eclipse环境搭建的私信，故首发于知乎，转载需注明出处，文中描述皆为实际搭建过程记录，全部配图来至实际操作截图。</p><p style="margin:0px;margin-bottom:0.72em;">备注，系统是Windows7，Linux系统过程类似。</p><h2 style="margin:0px;font-style:inherit;font-variant:inherit;font-stretch:inherit;line-height:inherit;font-family:inherit;font-size:18px;margin-top:1em;margin-bottom:1em;font-weight:700;">1 准备工作</h2><p style="margin:0px;margin-bottom:0.72em;"><b style="font-weight:700;">1.1 安装包</b></p>1)<a href="https://link.zhihu.com/?target=http%3A//www.eclipse.org/downloads/" rel="nofollow noreferrer" style="color:inherit;text-decoration:none;cursor:pointer;border-bottom:1px solid rgba(64, 64, 64, 0.721569);" target="_blank">Eclipse IDE For C/C++ Developers<i></i></a><br/>2)<a href="https://link.zhihu.com/?target=http%3A//www.oracle.com/technetwork/java/javase/downloads/index.html" rel="nofollow noreferrer" style="color:inherit;text-decoration:none;cursor:pointer;border-bottom:1px solid rgba(64, 64, 64, 0.721569);" target="_blank">Java Runtime Environment<i></i></a><br/>3)<a href="https://link.zhihu.com/?target=http%3A//sourceforge.net/projects/gnuarmeclipse/" rel="nofollow noreferrer" style="color:inherit;text-decoration:none;cursor:pointer;border-bottom:1px solid rgba(64, 64, 64, 0.721569);" target="_blank">GNU ARM Eclipse Plug-in<i></i></a><br/>4)<a href="https://link.zhihu.com/?target=https%3A//sourcery.mentor.com/sgpp/lite/arm/portal/subscription%3F%40template%3Dlite" rel="nofollow noreferrer" style="color:inherit;text-decoration:none;cursor:pointer;border-bottom:1px solid rgba(64, 64, 64, 0.721569);" target="_blank">Sourcery CodeBench Lite For ARM EABI<i></i></a><br/>5)<a href="https://link.zhihu.com/?target=http%3A//opensource.zylin.com/embeddedcdt.html" rel="nofollow noreferrer" style="color:inherit;text-decoration:none;cursor:pointer;border-bottom:1px solid rgba(64, 64, 64, 0.721569);" target="_blank">Zylin Embedded CDT<i></i></a><br/>6)<a href="https://link.zhihu.com/?target=http%3A//www.segger.com/downloads.html%3Fpid%3D13" rel="nofollow noreferrer" style="color:inherit;text-decoration:none;cursor:pointer;border-bottom:1px solid rgba(64, 64, 64, 0.721569);" target="_blank">Segger JLink ARM_V474a<i></i></a><br/>7)<a href="https://link.zhihu.com/?target=http%3A//www.st.com/web/en/catalog/mmc/FM141/SC1169/SS1031/LN1565/PF164495" rel="nofollow noreferrer" style="color:inherit;text-decoration:none;cursor:pointer;border-bottom:1px solid rgba(64, 64, 64, 0.721569);" target="_blank">STM32F10x Standard Peripheral Library<i></i></a><p style="margin:0px;margin-bottom:0.72em;"><b style="font-weight:700;">1.2 安装过程</b></p><p style="margin:0px;margin-bottom:0.72em;"><b style="font-weight:700;">1.2.1     安装Eclipse</b><br/>1）安装JRE之后将JRE的安装路径添加到系统环境变量<br/>2）安装Eclipse安装之后第一次打开按要求设置workspace即可<br/><br/><b style="font-weight:700;">1.2.2     安装GNU ARM Eclipse插件</b><br/>1）打开Eclipse软件选择Help→Install New Software弹出如下对话框<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-85d41f803e7bd9b997099de67549245a_b.jpg" type="image/jpeg" height="538" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="883"/>2）点击Add弹出如下对话框，点击Location栏的Archive按钮选择已经下载的插件路径（注意此处使用已经下载完成的插件包来安装，后面安装Zylin Embedded CDT采用在线安装的方式，在Location中填入待安装插件的地址即可）<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-25e6fa2b875321107727666d0b363fe8_b.jpg" type="image/jpeg" height="191" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="479"/>3）点击OK后选择 CDT GNU Cross Development Tools 下面需要安装的插件<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-b2a09c7e1f1f021584774a55a77fb0bc_b.jpg" type="image/jpeg" height="538" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="883"/>4）点击Next后弹出如下对话框<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-51275e7aa80e8e8361a55a3a514cd09f_b.jpg" type="image/jpeg" height="538" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="883"/>5）继续点击Next后选择I accept the terms of the license agreements 接下来点击Finish弹出如下对话框<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-e083a94271a461009b9e1959afac7190_b.jpg" type="image/jpeg" height="185" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="548"/>6）点击OK后完成安装，此后根据提示重启Eclipse完成插件安装。<br/><br/><b style="font-weight:700;">1.2.3     安装Sourcery G++ Lite</b><br/>1）下载Windows平台安装版本软件，安装到系统C盘下面<br/>2）将Sourcery G++ Lite的安装路径添加到系统环境变量，这样工具链就可被Eclipse找到<br/>3）注意添加路径要深入到Bin文件下<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-a5b5e0fa79cf4c6340a6fc110e1798c5_b.jpg" type="image/jpeg" height="422" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="973"/><b style="font-weight:700;"><br/>1.2.4     安装Zylin CDT</b><br/>1）打开Eclipse开发环境选择Help→Install New Software弹出如下对话框<br/>2）在Work with栏中填入插件下载地址<a href="https://link.zhihu.com/?target=http%3A//opensource.zylin.com/zylincdt" rel="nofollow noreferrer" style="color:inherit;text-decoration:none;cursor:pointer;border-bottom:1px solid rgba(64, 64, 64, 0.721569);" target="_blank"><span style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:0px;line-height:0;font-family:a;color:transparent;text-shadow:none;background-color:transparent;">http://</span><span>opensource.zylin.com/zy</span><span style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:0px;line-height:0;font-family:a;color:transparent;text-shadow:none;background-color:transparent;">lincdt</span><span><span style="">...</span></span><i></i></a><br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-fc135dfd70867fabeb57b23a48f52518_b.jpg" type="image/jpeg" height="538" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="883"/>3）选中 Zylin Embedded CDT点击Next后弹出对话框<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-9f5f32be6f73dd44295bc3b610ca74d1_b.jpg" type="image/jpeg" height="538" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="883"/>4）点击Next后选择I accept the terms of the license agreements 接下来点击Finish弹出如下对话框<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-e769a2bebd5e4264aa330776864fc721_b.jpg" type="image/jpeg" height="185" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="548"/>5）点击OK后完成安装，此后根据提示重启Eclipse完成插件安装。<br/><br/><br/><b style="font-weight:700;">1.2.5     安装JLink ARM</b><br/>1）安装Segger JLink ARM后将安装目录添加到系统环境变量<br/>2）安装之后软件如下，注意Jlink、JLinkGDBServer、JFlashARM区别，请参考安装目录下面Doc中文档。<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-6599e54c8e68ddedf92b7c7cbdf35b91_b.jpg" type="image/jpeg" height="481" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="877"/><b style="font-weight:700;">1.2.6     STD_PERIPH_DRIVER</b><br/>1）下载官方最新外设驱动库STM32F10x_StdPeriph_Lib_V3.5.0<br/>2）驱动库结构如下<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-a3fb86f16ecbdec2634f2a0da4612381_b.jpg" type="image/jpeg" height="449" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;" width="366"/>3）启动文件路径<br/></p><br/><div><pre style="margin:1em 0px;padding-right:1em;padding-left:1em;overflow:auto;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;font-size:14px;word-wrap:break-word;background:rgb(235, 238, 245);border-radius:4px;"><code>\STM32F10x_StdPeriph_Lib_V3.5.0\Libraries\CMSIS\CM3\DeviceSupport\ST\STM32F10x\startup\TrueSTUDIO\startup_stm32f10x_hd.S
</code></pre></div><p style="margin:0px;margin-bottom:0.72em;">4）连接文件路径<br/></p><br/><div><pre style="margin:1em 0px;padding-right:1em;padding-left:1em;overflow:auto;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;font-size:14px;word-wrap:break-word;background:rgb(235, 238, 245);border-radius:4px;"><code>\STM32F10x_StdPeriph_Lib_V3.5.0\Project\STM32F10x_StdPeriph_Template\TrueSTUDIO\STM3210E-EVAL\stm32_flash.ld
</code></pre></div><br/><h2 style="margin:0px;font-style:inherit;font-variant:inherit;font-stretch:inherit;line-height:inherit;font-family:inherit;font-size:18px;margin-top:1em;margin-bottom:1em;font-weight:700;">2      工程配置</h2><b style="font-weight:700;">2.1 新建工程</b><br/>1）打开Eclipse开发环境，新建一个工程File→New→Project弹出如下对话框<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-fc2ed2af989d273259ded5f1a0a6b647_b.jpg" type="image/jpeg" height="500" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="525"/>2）选择C/C++下面的C Project在点击Next弹出如下对话框<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-03b4913fc37bf2deecd172db0b82315b_b.jpg" type="image/jpeg" height="706" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="577"/>3）在Project name栏中填入你的项目名称，Project type中选择ARM Cross Target Application下面的Empty Project，Toolchains中选择ARM Windows GCC(Sourcery Lite Bare)，然后点击Finish完成创建<p style="margin:0px;margin-bottom:0.72em;">4）此时把下载的外设库中的相关文件拷贝到创建的工程\STM32_Sourcery-G++_2013-11-03\目录下，在工程上右键选择Refresh刷新<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-1790942575ddd41c0ce47b53fa16cfdb_b.jpg" type="image/jpeg" height="598" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;" width="409"/><b style="font-weight:700;">2.2 启动与连接文件</b><br/><br/>在固件库中ST提供了一些编译器的工程模板，因此可以使用模板中的配置文件。TrueSTUDIO文件夹下存在几个文件夹。TrueSTUDIO是ST官方的编译器，也是GCC的，因此使用它模板中的配置文件。<br/><br/>1）打开</p><br/><div><pre style="margin:1em 0px;padding-right:1em;padding-left:1em;overflow:auto;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;font-size:14px;word-wrap:break-word;background:rgb(235, 238, 245);border-radius:4px;"><code>\STM32F10x_StdPeriph_Lib_V3.5.0\Libraries\CMSIS\CM3\DeviceSupport\ST\STM32F10x\Startup\TrueSTUDIO
</code></pre></div><p style="margin:0px;margin-bottom:0.72em;">可以看到在在目录下有好几个S文件，因为使用的是STM32F103ZET6因此这里选择startup_stm32f10x_hd.s，注意需要把后缀改为大写S，能够被Sourcery G++识别为汇编文件。<br/><br/>2）打开</p><br/><div><pre style="margin:1em 0px;padding-right:1em;padding-left:1em;overflow:auto;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;font-size:14px;word-wrap:break-word;background:rgb(235, 238, 245);border-radius:4px;"><code>\STM32F10x_StdPeriph_Lib_V3.5.0\Project\STM32F10x_StdPeriph_Template\TrueSTUDIO
</code></pre></div><p style="margin:0px;margin-bottom:0.72em;">可以看到在在目录下有几个文件夹，因为使用的是STM32F103ZET6因此这里选择STM3210E-EVAL文件下的stm32_flash.ld。<br/><br/><br/><b style="font-weight:700;">2.3 配置工程</b></p><p style="margin:0px;margin-bottom:0.72em;"><b style="font-weight:700;"><br/>2.3.1     配置编译器</b><br/>1）在工程上右键选择Properties弹出如下对话框<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-49018ef902364bf4e412fe62453d04c1_b.jpg" type="image/jpeg" height="580" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="818"/>2）选择C/C++ Build选项卡Builder type→External builder注意默认的编译命令是否为cs-make，如果不是请修改。<br/><br/>3）选择Setting选项卡弹出如下对话框，选择Process为cortex-m3其他默认。<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-6ba6bee44ed18f7756f038ba40c28ce5_b.jpg" type="image/jpeg" height="432" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="1088"/>4）选择ARM Windows GCC Compiler(Sourcery Lite Bare)下面的Preprocessor添加两个预定义STM32F10X_HD和USE_STDPERIPH_DRIVER<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-002a7c898aa4fe0d1b3d6afc56cf5f12_b.jpg" type="image/jpeg" height="432" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="1088"/>5）选择ARM Windows GCC Compiler(Sourcery Lite Bare)下面的Directories依次添加头文件路径<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-609792cf348af7b273866364162a6b16_b.jpg" type="image/jpeg" height="432" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="1088"/>6）选择ARM Windows GCC Linker(Sourcery Lite Bare)下面的General添加连接脚本文件<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-08667ff8814228ec07cfb9518a7feecb_b.jpg" type="image/jpeg" height="432" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="1088"/>7）选择ARM Windows GNU Create Flash Image(Sourcery Lite Bare)下面的Output选择为binary<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-c2c1f75c865978987f16f44c717ea474_b.jpg" type="image/jpeg" height="432" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="1088"/>8）在工程上右键选择Build Project等待编译完成<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-0c2c91ecb98cc8a282425193684c458d_b.jpg" type="image/jpeg" height="176" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="949"/><br/><b style="font-weight:700;">2.3.2     下载配置</b><br/><i>需要配置一个Eclipse下载脚本</i><br/><br/>1）新建一个文本jlink_flash.txt（在工程根目录下面）添加如下脚本<br/></p><br/><div><pre style="margin:1em 0px;padding-right:1em;padding-left:1em;overflow:auto;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;font-size:14px;word-wrap:break-word;background:rgb(235, 238, 245);border-radius:4px;"><code>   h 
  speed 4800 
  exec device = STM32F103ZE 
  loadbin STM32_Sourcery-G++_2013-11-03.bin 0x8000000 
  r 
  g 
  qc 
</code></pre></div><p style="margin:0px;margin-bottom:0.72em;"><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-677cc2d099de7d391881bc57874120b9_b.jpg" type="image/jpeg" height="311" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="709"/>2）需要把编译后的bin文件拷贝到工程根目录下面，需要与jlink_flash.txt在同一个目录。<br/><br/>3）添加Eclipse外部工具，添加一个菜单项实现烧录。选择Run→ External Tools →External Tool Configurations。依次在Location中填入Jlink的安装路径，Working Directory选择为当前工程路径，Argument中填入jlink_flash.txt。<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-d819f7bc27b7ea51eb4a9ce0b1ed8f2e_b.jpg" type="image/jpeg" height="522" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="800"/>4）点击Apply保存后点击Close关闭，这样在Eclipse菜单Run→External Tools下就可以看到新添加的jlink_flash选项了。<br/><br/><br/><b style="font-weight:700;">2.3.3     调试配置</b><br/><i>注意在这里我们添加对CPU寄存器观察等插件的安装（<a href="https://link.zhihu.com/?target=http%3A//sourceforge.net/projects/embsysregview/files/latest/download" rel="nofollow noreferrer" style="color:inherit;text-decoration:none;cursor:pointer;border-bottom:1px solid rgba(64, 64, 64, 0.721569);" target="_blank">Eclipse Embedded System Register View Plugin<i></i></a>）</i><br/><br/>1）选择Run→ Debug Configurations弹出如下对话框<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-ffec8eadb49abe6c75fb00a8d4e710f1_b.jpg" type="image/jpeg" height="522" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="800"/>2）在Zylin Embedded debug(Native)上面右键选择New弹出如下对话框，选择Main选项卡填入当前工程的axf/elf文件，然后勾选Application Console<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-799d6a3b0e4335e8391721a92cac2cf9_b.jpg" type="image/jpeg" height="522" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="800"/>3）选择Debugger选项卡，在GDB debugger栏填入arm-none-eabi-gdb，GDB command file栏不填<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-61dc49d29555301182063e216194aa05_b.jpg" type="image/jpeg" height="522" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="800"/>4）选择Commands选项卡，依次在上下两个编辑框填入如下内容<br/><i>在上面的编辑框中填入（以STM32F103ZE芯片为例）</i><br/></p><br/><div><pre style="margin:1em 0px;padding-right:1em;padding-left:1em;overflow:auto;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;font-size:14px;word-wrap:break-word;background:rgb(235, 238, 245);border-radius:4px;"><code># connect to the J-Link gdb server 
  target remote localhost:2331 

# Enable flash download and flash breakpoints. 
# Flash download and flash breakpoints are features of 
# the J-Link software which require separate licenses 
# from SEGGER. 
# Select flash device 
  monitor flash device = STM32F103ZE 

# Enable FlashDL and FlashBPs 
  monitor flash download = 1 
  monitor flash breakpoints = 1 

# Clear all pendig breakpoints 
  monitor clrbp 

# Set gdb server to little endian 
  monitor endian little 

# Set JTAG speed to 5 kHz 
  monitor speed 5 

# Reset the target 
  monitor reset 
  monitor sleep 100 

# Set JTAG speed in khz 
  monitor speed auto 

# Vector table placed in Flash 
  monitor writeu32 0xE000ED08 = 0x00000000 
</code></pre></div><p style="margin:0px;margin-bottom:0.72em;"><i>在下面的编辑框中填入</i><br/></p><br/><div><pre style="margin:1em 0px;padding-right:1em;padding-left:1em;overflow:auto;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;font-size:14px;word-wrap:break-word;background:rgb(235, 238, 245);border-radius:4px;"><code>monitor reg r13 = (0x00000000) 
monitor reg pc = (0x00000004) 
break ResetHandler 
break main 
continue 
</code></pre></div><p style="margin:0px;margin-bottom:0.72em;"><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-87c7fded9441deec3bc0c9fb801cf6bb_b.jpg" type="image/jpeg" height="522" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="800"/>6）点击Apply保存之后Close完成设置。<br/><br/><br/>   上面的脚本可以在这里找到参考脚本<a href="https://link.zhihu.com/?target=http%3A//www.yagarto.de/examples/index.html" rel="nofollow noreferrer" style="color:inherit;text-decoration:none;cursor:pointer;border-bottom:1px solid rgba(64, 64, 64, 0.721569);" target="_blank">http://www.yagarto.de/<i></i></a>，根据您的芯片型号下载合适的压缩包，解压之后，其中prj目录中会有若干gdb文件。</p><p style="margin:0px;margin-bottom:0.72em;">例如芯片型号为stm32103ze，则下载STM3210ETest，解压之后，里面有4个后缀为gdb的文件，分别是</p><br/><div><pre style="margin:1em 0px;padding-right:1em;padding-left:1em;overflow:auto;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;font-size:14px;word-wrap:break-word;background:rgb(235, 238, 245);border-radius:4px;"><code>stm32_flash_jlink_1.gdb
stm32_flash_jlink_2.gdb
stm32_ram_jlink_1.gdb
stm32_ram_jlink_2.gdb
</code></pre></div><div><pre style="margin:1em 0px;padding-right:1em;padding-left:1em;overflow:auto;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;font-size:14px;word-wrap:break-word;background:rgb(235, 238, 245);border-radius:4px;"><code>其中stm32_flash_jlink_1.gdb与stm32_flash_jlink_2.gdb用于调试flash中的程序。
打开stm32_flash_jlink_1.gdb文件，将其中的内容复制到上面的编辑框中.
打开stm32_flash_jlink_2.gdb文件，将其中的内容复制到下面的编辑框中。
</code></pre></div><p style="margin:0px;margin-bottom:0.72em;">   这上下两个编辑框填入的内容实际就是通过gdb控制jlink的gdb server的脚本，关于他们的含义以及用法请参考jlink软件包Manuals目录下的《J-link gdb server user guide》文档。如果没有完全适合您的芯片的脚本，那么您需要适当修改上述脚本，对于stm32系列MCU，您只需要修改STM32F103ZE为您的MCU类型，对于其他型号的MCU配置，您需要查看《J-link gdb server user guide》文档。<br/><br/><br/><b style="font-weight:700;">2.3.4     启动调试</b><br/><br/>1）启动Jlink安装包中的JLinkGDBServer<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-f6c5d0bb950ce1e08a149278b19e11f2_b.jpg" type="image/jpeg" height="478" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="460"/>2）设置好目标芯片和速度之后点击OK完成配置<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-dd81ac46127fed79bd867a2d5217442c_b.jpg" type="image/jpeg" height="405" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="550"/>3）选择Debug按钮下面的STM32_Sourcery-G++_2013-11-03 Debug进入调试模式<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-d80bd46549e6cef5276e3576343ee089_b.jpg" type="image/jpeg" height="351" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="1366"/>4）此时的J-Link GDB Server状态如下<br/><img src="STM32 开发环境用哪个呢？ - 知乎_files/v2-f61f28f38a1f8863e9fe308487517355_b.jpg" type="image/jpeg" height="405" style="display:block;max-width:100%;margin-top:0.72em;margin-bottom:0.72em;cursor:-webkit-zoom-in;" width="550"/>5）可以尽情的调试了，设置你的断点吧，Enjoy it!</p></span></div></div></div></div></div></div></div></div></div></div></div></span></div></div></div></div></div><br/></div></span>
</div></body></html> 