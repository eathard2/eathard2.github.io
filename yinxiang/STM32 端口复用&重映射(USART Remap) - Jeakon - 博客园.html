<html>
<head>
  <title>STM32 端口复用&amp;重映射(USART Remap) - Jeakon - 博客园</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/304720 (zh-CN, DDL); Windows/6.1.7601 Service Pack 1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="837"/>
<h1>STM32 端口复用&amp;重映射(USART Remap) - Jeakon - 博客园</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2017/4/25 20:39</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="http://www.cnblogs.com/jeakon/archive/2012/10/04/2816798.html"><i>http://www.cnblogs.com/jeakon/archive/2012/10/04/2816798.html</i></a></td></tr>
</table>
</div>
<br/>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div><div style="font-family:&quot;PingFang SC&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;color:rgb(0, 0, 0);background-color:rgb(230, 230, 230);font-size:14px;"><div style="background-color:rgb(255, 255, 255);box-shadow:rgba(100, 100, 100, 0.298039) 0px 2px 6px;"><div style="text-align:left;"><div style="text-overflow:ellipsis;overflow:hidden;"><div><div><div style="text-overflow:ellipsis;overflow:hidden;">
	<div style="margin:0px;padding:0px;">
		<h1 style="float:left;margin:0px;padding:0px;border-left:3px solid rgb(33, 117, 155);margin-bottom:10px;clear:both;font-weight:bold;font-size:130%;width:auto;border:0px;line-height:1.5;padding-left:5px;">
			<a href="http://www.cnblogs.com/jeakon/archive/2012/10/04/2816798.html" style="margin:0px;padding:0px;outline:none;text-decoration:none;color:rgb(33, 117, 155);transition:all 0.4s linear 0s;">STM32 端口复用&amp;重映射(USART Remap)</a>
		</h1>
		<div style="margin:0px;padding:0px;clear:both;"></div>
		<div style="margin:0px;padding:0px;color:rgb(0, 0, 0);line-height:1.7;font-size:14px;">
			<div style="margin:0px;padding:0px;margin-bottom:20px;word-break:break-word;"><p style="padding:0px;margin:10px auto;text-indent:0px;">下面跟大家说一下STM32单片机的端口重映射,因为是以自己为实例.这里是以USART1的重映射为例..</p>
<p style="padding:0px;margin:10px auto;text-indent:0px;">        因为我要一个TFT_LCD屏的主控板,考虑到FSMC 我选用了STM32F103VCT6 型号的CPU,一不小心串口接到USART1上了.因为在调程序时才发现错了,没得办法,只能通过端口重映射来解决.但是以前没用过端口重映射,只闻其名,未用其身,所以..呵呵 ...只能从头去看了.</p>
<p style="padding:0px;margin:10px auto;text-indent:0px;">         STM32上有很多I/O口，也有很多的内置外设想I2C,ADC,ISP,USART等，为了节省引出管脚，这些内置外设基本上是与I/O口共用管脚的，也就是I/O管脚的复用功能。但是STM32还有一特别之处就是：很多复用内置的外设的I/O引脚可以通过重映射功能，从不同的I/O管脚引出，即复用功能的引脚是可通过程序改变的.读到这里相信大家都应该了解了端口重映射的一些概念了.原理上的东西不细说了,大家可以看手册或者网上查,这方面的资料还是很多的.下面说说我的调试经历.</p>
<p style="padding:0px;margin:10px auto;text-indent:0px;">        不知道是什么原因 PCB制图时把串口接到USART1上了,当时也没在意,等我把USART测试程序写好烧进去硬件仿真时,串口给的是乱码,我当时就觉得奇怪.把程序检查了好几遍就是查不出问题来,以为是硬件有问题,但突然想到了STM有复用功能,心想会不会是这里有鬼?于是找来datasheet 一看 ,真相大白</p>
<p style="padding:0px;margin:10px auto;text-indent:0px;"><img src="STM32 端口复用&重映射(USART Remap) - Jeakon - 博客园_files/1349313458_3000.jpg" type="image/jpeg" alt="" height="312" style="margin:0px;padding:0px;border:0px;height:auto;max-width:300px;width:686px;" width="686"/><br style="margin:0px;padding:0px;"/>
</p>
<p style="padding:0px;margin:10px auto;text-indent:0px;"></p>
<p style="padding:0px;margin:10px auto;text-indent:0px;">三个红框交汇处.STM32F103VCT6 这个CPU的USART1接的是PB6/PB7 但是上电初始化后默认功能并非是USART1.所以想要用串口功能 .必须用端口重映射..</p>
   大家知道,STM32的单片机每个功能模块有自己的时钟系统,所以要想要调用STM32单片机的功能模块时 必须先配置对应时钟,然后才能去操作相应的功能模块.端口重映射也一样.如图示:<br style="margin:0px;padding:0px;"/>
<p style="padding:0px;margin:10px auto;text-indent:0px;"><img alt="" height="23" src="" style="margin:0px;padding:0px;border:0px;height:auto;max-width:300px;" width="0"></img><img src="STM32 端口复用&重映射(USART Remap) - Jeakon - 博客园_files/1349313893_5693.jpg" type="image/jpeg" alt="" height="132" style="margin:0px;padding:0px;border:0px;height:auto;max-width:300px;" width="587"/></p>
<p style="padding:0px;margin:10px auto;text-indent:0px;"></p>
<p style="padding:0px;margin:10px auto;text-indent:0px;">重映射步骤为:</p>
<p style="padding:0px;margin:10px auto;text-indent:0px;">1.打开重映射时钟和USART重映射后的I/O口引脚时钟, </p>
<p style="padding:0px;margin:10px auto;text-indent:0px;">          RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOB | RCC_APB2Periph_AFIO,ENABLE);</p>
<p style="padding:0px;margin:10px auto;text-indent:0px;">2.I/O口重映射开启.</p>
<p style="padding:0px;margin:10px auto;text-indent:0px;">                   GPIO_PinRemapConfig(GPIO_Remap_USART1,ENABLE);</p>
<p style="padding:0px;margin:10px auto;text-indent:0px;">3.配制重映射引脚, 这里只需配置重映射后的I/O,原来的不需要去配置.</p>
<p style="padding:0px;margin:10px auto;text-indent:0px;">                             GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6;<br style="margin:0px;padding:0px;"/>
                             GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP;<br style="margin:0px;padding:0px;"/>
                             GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;<br style="margin:0px;padding:0px;"/>
                             GPIO_Init(GPIOB, &amp;GPIO_InitStructure);</p>
<p style="padding:0px;margin:10px auto;text-indent:0px;"><br style="margin:0px;padding:0px;"/>
                              GPIO_InitStructure.GPIO_Pin = GPIO_Pin_7;<br style="margin:0px;padding:0px;"/>
                              GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN_FLOATING;<br style="margin:0px;padding:0px;"/>
                               GPIO_Init(GPIOB,&amp;GPIO_InitStructure);</p>
<p style="padding:0px;margin:10px auto;text-indent:0px;">      只需要这三步,串口就可以正常使用了,简单吧?  但是我纠结了大半个小时才搞定的,好多事情都是说起来容易做起来难的,希望我以后多多进步.不要眼高手低,嗯我正朝这个方向前进.<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
最后总结一下：<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
简单的说 STM32的 io 有3个功能一个是默认的 一个是复用 一个是重映射功能（这个其实也属于复用）<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
如果配置成复用 则将使用第2个功能 如果配置成复用 同时 相应的重映射配置了 则将使用第3个功能<br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
通常一个口的 复用+重映射有好多 不止两个 这时候就看你使能哪个设备了（哪个被使能就用哪个） <br style="margin:0px;padding:0px;"/>
<br style="margin:0px;padding:0px;"/>
开复用 + 使能设备+ 是否重映射就可以决定这个io口到底使用哪个功能</p>
<p style="padding:0px;margin:10px auto;text-indent:0px;"> </p>
<p style="padding:0px;margin:10px auto;text-indent:0px;"></p>
<br style="margin:0px;padding:0px;"/></div>
<div style="margin:0px;padding:0px;clear:both;"></div>
<div style="margin:0px;padding:0px;margin-top:20px;">
<div style="margin:0px;padding:0px;margin-bottom:10px;color:rgb(102, 102, 102);">分类: <a href="http://www.cnblogs.com/jeakon/category/437585.html" style="outline:none;margin:2px 5px 0px;padding:3px 14px;text-decoration:none;height:20px;line-height:20px;border-radius:10px;background:rgb(231, 231, 231);color:rgb(102, 102, 102);" target="_blank">STM32</a>,<a href="http://www.cnblogs.com/jeakon/category/444628.html" style="outline:none;margin:2px 5px 0px;padding:3px 14px;text-decoration:none;height:20px;line-height:20px;border-radius:10px;background:rgb(231, 231, 231);color:rgb(102, 102, 102);" target="_blank">STM32</a></div>
<div style="margin:0px;padding:0px;color:rgb(102, 102, 102);margin-top:0px;"></div>
<div style="margin:0px;padding:0px;"><div style="margin:0px;padding:10px 0px;margin-bottom:10px;margin-top:10px;border:1px dashed silver;font-size:12px;width:320px;text-align:center;">
        <a href="#" style="border-radius:10px;outline:none;margin:0px;box-shadow:rgba(0, 0, 0, 0.498039) 0px 1px 3px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAkCAYAAABIdFAMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHhJREFUeNo8zjsOxCAMBFB/KEAUFFR0Cbng3nQPw68ArZdAlOZppPFIBhH5EAB8b+Tlt9MYQ6i1BuqFaq1CKSVcxZ2Acs6406KUgpt5/LCKuVgz5BDCSb13ZO99ZOdcZGvt4mJjzMVKqcha68iIePB86GAiOv8CDADlIUQBs7MD3wAAAABJRU5ErkJggg%3D%3D&quot;) repeat-x;font-weight:bold;cursor:pointer;margin-right:10px;display:inline-block;text-decoration:none;text-shadow:rgba(0, 0, 0, 0.247059) 0px -1px 1px;vertical-align:middle;padding:3px 8px;background-color:rgb(45, 174, 191);border:none;color:rgb(255, 255, 255);">好文要顶</a>
            <a href="#" style="border-radius:10px;outline:none;margin:0px;box-shadow:rgba(0, 0, 0, 0.498039) 0px 1px 3px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAkCAYAAABIdFAMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHhJREFUeNo8zjsOxCAMBFB/KEAUFFR0Cbng3nQPw68ArZdAlOZppPFIBhH5EAB8b+Tlt9MYQ6i1BuqFaq1CKSVcxZ2Acs6406KUgpt5/LCKuVgz5BDCSb13ZO99ZOdcZGvt4mJjzMVKqcha68iIePB86GAiOv8CDADlIUQBs7MD3wAAAABJRU5ErkJggg%3D%3D&quot;) repeat-x;font-weight:bold;cursor:pointer;margin-right:10px;display:inline-block;text-decoration:none;text-shadow:rgba(0, 0, 0, 0.247059) 0px -1px 1px;vertical-align:middle;padding:3px 8px;background-color:rgb(227, 49, 0);border:none;color:rgb(255, 255, 255);">关注我</a>
    <a href="#" style="border-radius:10px;outline:none;margin:0px;box-shadow:rgba(0, 0, 0, 0.498039) 0px 1px 3px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAkCAYAAABIdFAMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHhJREFUeNo8zjsOxCAMBFB/KEAUFFR0Cbng3nQPw68ArZdAlOZppPFIBhH5EAB8b+Tlt9MYQ6i1BuqFaq1CKSVcxZ2Acs6406KUgpt5/LCKuVgz5BDCSb13ZO99ZOdcZGvt4mJjzMVKqcha68iIePB86GAiOv8CDADlIUQBs7MD3wAAAABJRU5ErkJggg%3D%3D&quot;) repeat-x;font-weight:bold;cursor:pointer;margin-right:10px;display:inline-block;text-decoration:none;text-shadow:rgba(0, 0, 0, 0.247059) 0px -1px 1px;vertical-align:middle;padding:3px 8px;background-color:rgb(255, 181, 21);border:none;color:rgb(255, 255, 255);">收藏该文</a>
    <a href="#" style="margin-right:10px;outline:none;margin:0px;box-shadow:none;background:none;font-weight:bold;cursor:pointer;display:inline-block;border-radius:10px;text-decoration:none;text-shadow:none;vertical-align:middle;padding:3px 2px;border:none;color:rgb(255, 255, 255);" title="分享至新浪微博"><img src="STM32 端口复用&重映射(USART Remap) - Jeakon - 博客园_files/icon_weibo_24.png" type="image/png" alt="" height="24" style="margin:0px;padding:0px;height:auto;border:none;vertical-align:middle;margin-left:5px;box-shadow:none;max-width:300px;" width="24"/></a>
    <a href="#" style="margin-right:10px;outline:none;margin:0px;box-shadow:none;background:none;font-weight:bold;cursor:pointer;display:inline-block;border-radius:10px;text-decoration:none;text-shadow:none;vertical-align:middle;padding:3px 2px;border:none;color:rgb(255, 255, 255);" title="分享至微信"><img src="STM32 端口复用&重映射(USART Remap) - Jeakon - 博客园_files/wechat.png" type="image/png" alt="" height="24" style="margin:0px;padding:0px;border:medium none;width:24px;height:24px;box-shadow:none;margin-left:5px;vertical-align:middle;max-width:300px;" width="24"/></a>
</div>
<div style="margin:0px;padding:0px;float:left;width:280px;margin-top:0px;margin-bottom:10px;color:rgb(0, 0, 0);margin-left:0px;font-size:12px;">
    <div style="margin:0px;padding:0px;float:left;line-height:18px;">
            <a href="http://home.cnblogs.com/u/jeakon/" style="margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;" target="_blank"><img src="STM32 端口复用&重映射(USART Remap) - Jeakon - 博客园_files/u454457.jpg" type="image/jpeg" alt="" height="48" style="margin:0px;padding:0px;height:auto;border:0px;vertical-align:top;float:left;margin-right:5px;padding-top:5px;padding-left:2px;max-width:300px;" width="48"/></a>
        <div style="margin:0px;padding:0px;float:left;line-height:18px;">
            <a href="http://home.cnblogs.com/u/jeakon/" style="margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;">Jeakon</a><br style="margin:0px;padding:0px;"/>
            <a href="http://home.cnblogs.com/u/jeakon/followees" style="margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;">关注 - 4</a><br style="margin:0px;padding:0px;"/>
            <a href="http://home.cnblogs.com/u/jeakon/followers" style="margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;">粉丝 - 14</a>
        </div>
    </div>
    <div style="margin:0px;padding:0px;clear:both;"></div>
    <div style="margin:0px;padding:0px;"></div>
    <div style="margin:0px;padding:0px;">
                <a href="#" style="margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;">+加关注</a>
    </div>
</div>
<div style="margin:0px;padding:0px;float:right;margin-bottom:10px;margin-right:30px;font-size:12px;width:125px;text-align:center;margin-top:10px;">
    <div style="margin:0px;padding:0px;float:left;width:46px;height:52px;background:url(&quot;http://static.cnblogs.com/images/upup.gif&quot;) no-repeat;text-align:center;cursor:pointer;margin-top:2px;padding-top:5px;">
        <span style="margin:0px;padding:0px;font-size:14px;color:rgb(7, 93, 179);font-family:Verdana;line-height:1.5em;">3</span>
    </div>
    <div style="text-align:center;padding:0px;margin:0px;height:52px;background:url(&quot;http://static.cnblogs.com/images/downdown.gif&quot;) no-repeat;margin-left:20px;cursor:pointer;margin-top:2px;padding-top:5px;width:46px;float:right;">
        <span style="margin:0px;padding:0px;font-size:14px;color:rgb(7, 93, 179);font-family:Verdana;line-height:1.5em;">0</span>
    </div>
    <div style="margin:0px;padding:0px;clear:both;"></div>
    <div style="margin:0px;padding:0px;margin-top:5px;margin-left:0px;font-size:12px;color:gray;">
    </div>
</div>
</div>
<div style="margin:0px;padding:0px;clear:both;"></div>
<div style="margin:0px;padding:0px;line-height:1.8;font-size:12px;"><a href="http://www.cnblogs.com/jeakon/archive/2012/09/07/2816799.html" style="margin:0px;padding:0px;outline:none;color:black;text-decoration:none;">« </a> 上一篇：<a href="http://www.cnblogs.com/jeakon/archive/2012/09/07/2816799.html" style="margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;" title="发布于2012-09-07 14:02">Android MediaPlayer使用方法简单介绍</a><br style="margin:0px;padding:0px;"/><a href="http://www.cnblogs.com/jeakon/archive/2012/10/04/2816797.html" style="margin:0px;padding:0px;outline:none;color:black;text-decoration:none;">» </a> 下一篇：<a href="http://www.cnblogs.com/jeakon/archive/2012/10/04/2816797.html" style="margin:0px;padding:0px;outline:none;color:black;text-decoration:underline;" title="发布于2012-10-04 17:46">stm32 外部中断的使用（含实例）</a><br style="margin:0px;padding:0px;"/></div>
</div>


		</div>
		<div style="width:100%;margin:0px;padding:0px;float:left;font-size:13px;clear:both;padding-right:5px;line-height:1.5;background:none;color:rgb(102, 102, 102);text-align:left;padding-left:0px;margin-top:5px;">posted @ <span style="margin:0px;padding:0px;">2012-10-04 09:19</span> <a href="http://www.cnblogs.com/jeakon/" style="margin:0px;padding:0px;outline:none;text-decoration:none;color:rgb(102, 102, 102);">Jeakon</a> 阅读(<span style="margin:0px;padding:0px;">19567</span>) 评论(<span style="margin:0px;padding:0px;">0</span>)  <a href="https://i.cnblogs.com/EditPosts.aspx?postid=2816798" rel="nofollow" style="margin:0px;padding:0px;outline:none;text-decoration:none;color:rgb(102, 102, 102);">编辑</a> <a href="http://www.cnblogs.com/jeakon/archive/2012/10/04/2816798.html#" style="margin:0px;padding:0px;outline:none;text-decoration:none;color:rgb(102, 102, 102);">收藏</a></div>
	</div>
	

	
</div></div></div></div></div></div></div></div></div><br/></div></span>
</div></body></html> 